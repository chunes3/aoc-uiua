Input ← "03" &fras
Parse ← . @\n≠ ⊜∘

NumberPositions ← ⊃(@0≥|@9≤) ↧ ⊃(△⇡)∘ ∩(¯2☇) ⊜□

PartI ← ⊃(
  ¤¤
|
  ⊃(@.=|@0≥|@9≤) ↧↥¬ ¤ 3⇡ 1- .⊞⊟ 1☇ ≡⬚0↻ /+ ⊚ ¤
|
  NumberPositions
) ⊃∘(⊐≡(∊ /↥)) ▽ ≡(⊔ ≡⊡ parse) /+

PartII ← ⊃(
  ¤¤¤
|
  NumberPositions ¤
|
  @*= ⊚ ≡(¤ 3⇡ 1- .⊞⊟ 1☇ ≡+)
) ≡(¤: ⊃∘≡(⊔ ∊ /↥) ▽ □) ⊃∘≡(⊔ ⧻ 2=) ▽ ≡(⊔ ≡(⊔ ≡⊡ parse) /×) /+
